<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <title>新聞管理後台 - 強發金屬</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-5">
    <div class="container mt-5 shadow-sm p-4 bg-white rounded">
        <h2>發布最新消息</h2>
        <form id="newsForm">
            <div class="mb-3">
                <label class="form-label">新聞標題</label>
                <input type="text" id="title" class="form-control" required>
            </div>
            <div class="mb-3">
                <label class="form-label">內容</label>
                <textarea id="content" class="form-control" rows="5" required></textarea>
            </div>
            <div class="mb-3">
                <label class="form-label">圖片上傳（選填）</label>
                <input type="file" id="image" class="form-control" accept="image/*">
            </div>
            <button type="submit" class="btn btn-primary">發布消息</button>
        </form>
    </div>

    <script>
        document.getElementById('newsForm').onsubmit = async (e) => {
            e.preventDefault();

            const formData = new FormData();
            formData.append('title', document.getElementById('title').value);
            formData.append('content', document.getElementById('content').value);
            formData.append('date', new Date().toLocaleDateString('zh-TW'));

            const imageInput = document.getElementById('image');
            if (imageInput.files && imageInput.files[0]) {
                formData.append('image', imageInput.files[0]);
            }

            const res = await fetch('https://chanfar-news-api.fs80067.workers.dev/api/news', {
                method: 'POST',
                body: formData
            });

            if (res.ok) {
                alert('發布成功！');
                location.reload();
            } else {
                alert('發布失敗，請檢查權限');
            }
        };
    </script>
</body>
</html>
